<!DOCTYPE html>
<html ng-app="ConfiguratorApp">
<head>
	<title></title>
	<meta charset="utf-8"> 
	<link rel="stylesheet" href="css/main.css">
	<script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="js/angular.min.js"></script>
	<script type="text/javascript" src="js/configurator.js"></script>
	<script type="text/javascript" src="js/ngDraggable.js"></script>
</head>
<body>
	<div class="configurator" ng-controller="ConfiguratorCtrl">
		{{currentShelf.motorCollision}}
		<br>
		{{currentShelf.spiralCollision}}
		<div class="tools">
			<ul>
				<li ng-repeat="tool in tools">
					<div class="title">
						{{tool.name}}
					</div>
					<div class="tool-container"
						ng-drag="true"
						ng-drag-data="tool"
						ng-drag-success="onToolDragComplete($data, $event)"
						ng-mousedown="onToolMouseDown(tool)"
						ng-mouseup="onToolMouseUp(tool)">
						<div class="{{tool.toolClass}}"></div>
					</div>
				</li>
			</ul>
		</div>

		<div class="machine" ng-show="mode == modes.machine">
			<div class="hole"
				ng-repeat="hole in holes"
				ng-drop="true"
				ng-drop-success="onHoleDropComplete($data, $event, hole)"
				ng-class="{'not-empty': hole.shelf,
				'tool-mouse-over': tools.shelf.mouseOver && !hole.shelf}">
				<div class="circle left"></div>
				<div class="circle right"></div>
				<div class="hole-label">{{hole.id}}</div>
				<div class="configure-shelf" ng-show="hole.shelf">
					<button type="button" ng-click="configureShelf(hole.shelf)">Настроить</button>
				</div>
				<div class="{{hole.shelf.objectClass}}"
					ng-show="hole.shelf"
					ng-drag="true"
					ng-drag-data="hole.shelf"
					ng-drag-success="onShelfDragComplete($data, $event, hole)"
					ng-mousedown="onToolMouseDown(tools.shelf)"
					ng-mouseup="onToolMouseUp(tools.shelf)"></div>
			</div>
		</div>

		<div class="shelf-generator" ng-show="mode == modes.shelf">
			<div class="shelf-model">
				<div class="motor-place"></div>
				<div class="spiral-places">
					<div class="place-offset"></div>
					<div class="spiral-place" ng-repeat="spiralPlace in currentShelf.spiralPlaces">
						<div class="spiral-hole"></div>
						<div class="rail"></div>
					</div>
					<div class="place-offset"></div>
				</div>
				<div class="single-spiral-detectors">
					<div class="place-offset"></div>
					<div class="single-spiral-detector {{spiralPlace.class}}"
						ng-class="{'tool-mouse-over': currentTool.mouseOver}"
						ng-repeat="spiralPlace in currentShelf.spiralPlaces"
						ng-drop="true"
						ng-drop-success="onSpiralPlaceDropComplete($data, $event, $index)">
						<div class="{{spiralPlace.item.objectClass}}"
							ng-drag="true"
							ng-drag-data="spiralPlace.item"
							ng-drag-success="onItemDragComplete($data, $event, $index)"
							ng-mousedown="onToolMouseDown(spiralPlace.item, $index)"
							ng-mouseup="onToolMouseUp(spiralPlace.item, $index)"></div>
						<div class="detector-rail"></div>
					</div>
					<div class="place-offset"></div>
				</div>
				<div class="motor-detectors">
					<div class="motor-offset"></div>
					<div class="motor-detector {{motorPlace.class}}"
						ng-class="{'tool-mouse-over': currentTool.mouseOver}"
						ng-repeat="motorPlace in currentShelf.motorPlaces"
						ng-drop="true"
						ng-drop-success="onMotorPlaceDropComplete($data, $event, $index)">
						<div class="{{motorPlace.item.objectClass}}"
							ng-drag="true"
							ng-drag-data="motorPlace.item"
							ng-drag-success="onItemDragComplete($data, $event, $index)"
							ng-mousedown="onToolMouseDown(motorPlace.item, $index)"
							ng-mouseup="onToolMouseUp(motorPlace.item, $index)"></div>
					</div>
					<div class="motor-offset"></div>
				</div>
			</div>
			<div class="to-machine">
				<button type="button" ng-click="configureMachine()">К автомату</button>
			</div>
		</div>

		<div class="garbage"
		ng-drop="true"
		ng-drop-success="onGarbageDropComplete($data, $event)">
			Мусор
		</div>
	</div>
</body>
</html>