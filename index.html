<!DOCTYPE html>
<html ng-app="ConfiguratorApp">
<head>
	<title></title>
	<meta charset="utf-8"> 
	<link rel="stylesheet" href="css/main.css">
	<script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="js/angular.min.js"></script>
	<script type="text/javascript" src="js/configurator.js"></script>
	<script type="text/javascript" src="js/ngDraggable.js"></script>
</head>
<body>
	<div class="configurator" ng-controller="ConfiguratorCtrl">
		<div class="tools {{toStorage}}"
		ng-drop="true"
		ng-drop-success="onGarbageDropComplete($data, $event)">
			<div class="title">
				<strong>Склад</strong>
			</div>
			<ul>
				<li ng-repeat="tool in tools" ng-show="tool.count > 0">
					<div class="title">
						{{tool.name}} ({{tool.count}})
					</div>
					<div class="tool-container {{tool.toolClass}}"
					ng-drag="true"
					ng-drag-data="tool"
					ng-drag-success="onToolDragComplete($data, $event)"
					ng-mousedown="onToolMouseDown(tool)"
					ng-mouseup="onToolMouseUp(tool)">
						<div></div>
					</div>
				</li>
			</ul>
		</div>

		<div class="machine" ng-show="mode == modes.machine">
			<div>
				<div class="machine-place-offset"></div>
				<div class="machine-place" ng-repeat="place in machineTools.shelf.spiralPlaces"></div>
				<div class="machine-place-offset"></div>
			</div>
			<div class="hole"
			ng-repeat="hole in holes"
			ng-drop="true"
			ng-drop-success="onHoleDropComplete($data, $event, hole)"
			ng-class="{'not-empty': hole.shelf,
				'tool-mouse-over': tools.shelf.mouseOver && !hole.shelf}">
				<div class="circle left"></div>
				<div class="circle right"></div>
				<div class="hole-label">{{hole.id}}</div>
				<div class="configure-shelf" ng-show="hole.shelf">
					<button type="button" ng-click="configureShelf(hole.shelf)">Настроить</button>
				</div>
				<div class="{{hole.shelf.objectClass}}"
				ng-show="hole.shelf"
				ng-drag="true"
				ng-drag-data="hole.shelf"
				ng-drag-success="onShelfDragComplete($data, $event, hole)"
				ng-mousedown="onToolMouseDown(tools.shelf, $index)"
				ng-mouseup="onToolMouseUp(tools.shelf, $index)">
					<div class="machine-items">
						<div class="machine-place-offset"></div>
						<div class="machine-place" ng-repeat="motorPlace in hole.shelf.motorPlaces">
							<div class="{{motorPlace.item.machineClass}}"></div>
						</div>
						<div class="machine-place-offset"></div>
					</div>
					<div class="machine-items">
						<div class="machine-place-offset"></div>
						<div class="machine-place" ng-repeat="spiralPlace in hole.shelf.spiralPlaces">
							<div class="{{spiralPlace.item.machineClass}}"></div>
						</div>
						<div class="machine-place-offset"></div>
					</div>
				</div>
			</div>
		</div>

		<div class="shelf-generator" ng-show="mode == modes.shelf">
			<div class="shelf-model">
				<div class="motor-place"></div>
				<div class="spiral-places">
					<div class="place-offset"></div>
					<div class="spiral-place" ng-repeat="spiralPlace in currentShelf.spiralPlaces">
						<div class="spiral-hole"></div>
						<div class="rail"></div>
					</div>
					<div class="place-offset"></div>
				</div>
				<div class="single-spiral-detectors">
					<div class="place-offset"></div>
					<div class="single-spiral-detector {{spiralPlace.class}}"
					ng-class="{'tool-mouse-over': currentTool.mouseOver}"
					ng-repeat="spiralPlace in currentShelf.spiralPlaces"
					ng-drop="true"
					ng-drop-success="onSpiralPlaceDropComplete($data, $event, $index)">
						<div class="{{spiralPlace.item.objectClass}}"
						ng-drag="true"
						ng-drag-data="spiralPlace.item"
						ng-drag-success="onItemDragComplete($data, $event, $index)"
						ng-mousedown="onToolMouseDown(spiralPlace.item, $index)"
						ng-mouseup="onToolMouseUp(spiralPlace.item, $index)"></div>
						<div class="detector-rail"></div>
					</div>
					<div class="place-offset"></div>
				</div>
				<div class="motor-detectors">
					<div class="motor-offset"></div>
					<div class="motor-detector {{motorPlace.class}}"
					ng-class="{'tool-mouse-over': currentTool.mouseOver}"
					ng-repeat="motorPlace in currentShelf.motorPlaces"
					ng-drop="true"
					ng-drop-success="onMotorPlaceDropComplete($data, $event, $index)">
						<div class="{{motorPlace.item.objectClass}}"
						ng-drag="true"
						ng-drag-data="motorPlace.item"
						ng-drag-success="onItemDragComplete($data, $event, $index)"
						ng-mousedown="onToolMouseDown(motorPlace.item, $index)"
						ng-mouseup="onToolMouseUp(motorPlace.item, $index)"></div>
					</div>
					<div class="motor-offset"></div>
				</div>
			</div>
			<div class="to-machine">
				<button type="button" ng-click="configureMachine()">К автомату</button>
			</div>
		</div>
	</div>
</body>
</html>